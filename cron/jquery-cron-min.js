(function(e){"use strict";function y(t){var n,r,i,s=[],o=/^((\*(\/\d+)?)|(\d+(,\d+)*))$/,u={valid:false,cron_str:t};if(!t){return u}i=e.trim(t).split(" ");if(i.length!=5){return u}for(n=0;n<i.length;n++){r=i[n];if(!o.test(r)){return u}if(r.indexOf("/")>0){u.repeatTime=r.split("/")[1];u.repeatTimePos=n;r="*"}if(r.indexOf(",")>0){u[m[n]]=r.split(",")}else{u[m[n]]=[r]}if(r==="*"){s.push("*")}else{s.push("x")}}if(u.repeatTime){u.cron_type=m[u.repeatTimePos];u.valid=true}else{r=s.join(" ");for(n in g){if(g[n].test(r)){u.cron_type=n;u.valid=true;break}}}return u}function b(e){var t=e.data("block");var n,r,i,s,o;n=r=i=s=o="*";var u=t["period"].find("input.cron-period-repeat").val();if(!u){u=1}var a=t["period"].find("select").val();switch(a){case"minute":if(u>1){n+="/"+u}break;case"hour":n=t["mins"].find("select").val();if(u>1){r+="/"+u}break;case"day":n=t["time"].find("select.cron-time-min").val();r=t["time"].find("select.cron-time-hour").val();if(u>1){i+="/"+u}break;case"week":n=t["time"].find("select.cron-time-min").val();r=t["time"].find("select.cron-time-hour").val();o=t["dow"].find("select").val();break;case"month":n=t["time"].find("select.cron-time-min").val();r=t["time"].find("select.cron-time-hour").val();i=t["dom"].find("select").val();if(u>1){s+="/"+u}break;case"year":n=t["time"].find("select.cron-time-min").val();r=t["time"].find("select.cron-time-hour").val();i=t["dom"].find("select").val();s=t["month"].find("select").val();break;default:return a}if(!n){n="*"}if(!r){r="*"}if(!i){i="*"}if(!s){s="*"}if(!o){o="*"}return[n,r,i,s,o].join(" ")}var t={initial:"* * * * *",minuteOpts:{minWidth:100,itemWidth:30,columns:4,rows:undefined,title:"Minutes Past the Hour",prompt:"every minute"},timeHourOpts:{minWidth:100,itemWidth:20,columns:2,rows:undefined,title:"Time: Hour",prompt:"every hour"},domOpts:{minWidth:100,itemWidth:30,columns:undefined,rows:10,title:"Day of Month",prompt:"every day"},monthOpts:{minWidth:100,itemWidth:100,columns:2,rows:undefined,title:undefined,prompt:"every month"},dowOpts:{minWidth:100,itemWidth:undefined,columns:undefined,rows:undefined,title:undefined,prompt:"every day"},timeMinuteOpts:{minWidth:100,itemWidth:20,columns:4,rows:undefined,title:"Time: Minute",prompt:"every minute"},effectOpts:{openSpeed:400,closeSpeed:400,openEffect:"slide",closeEffect:"slide",hideOnMouseOut:true},url_set:undefined,customValues:undefined,onChange:undefined,useGentleSelect:false,allowIntervalExpression:true};var n,r,i;var s="";for(n=0;n<60;n++){r=n<10?"0":"";s+="<option value='"+n+"'>"+r+n+"</option>\n"}var o="";for(n=0;n<24;n++){r=n<10?"0":"";o+="<option value='"+n+"'>"+r+n+"</option>\n"}var u,a="";for(n=1;n<32;n++){if(n===1||n===21||n===31){u="st"}else if(n===2||n===22){u="nd"}else if(n===3||n===23){u="rd"}else{u="th"}a+="<option value='"+n+"'>"+n+u+"</option>\n"}var f="";var l=["January","February","March","April","May","June","July","August","September","October","November","December"];for(n=0,i=l.length;n<i;n++){f+="<option value='"+(n+1)+"'>"+l[n]+"</option>\n"}var c="";var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(n=0,i=h.length;n<i;n++){c+="<option value='"+n+"'>"+h[n]+"</option>\n"}var p="";var d=["minute","hour","day","week","month","year"];for(n=0,i=d.length;n<i;n++){p+="<option value='"+d[n]+"'>"+d[n]+"</option>\n"}var v={minute:["interval"],hour:["interval","mins"],day:["interval","time"],week:["dow","time"],month:["interval","dom","time"],year:["dom","month","time"]};var m=["minute","hour","day","month","week"];var g={minute:/^(\*\s){4}\*$/,hour:/^.\s(\*\s){3}\*$/,day:/^(.\s){2}(\*\s){2}\*$/,week:/^(.\s){2}(\*\s){2}.$/,month:/^(.\s){3}\*\s\*$/,year:/^(.\s){4}\*$/};var w={init:function(n){var r=n||{};var i=e.extend([],t,r);var u=e.extend({},t.effectOpts,r.effectOpts);e.extend(i,{minuteOpts:e.extend({},t.minuteOpts,u,r.minuteOpts),domOpts:e.extend({},t.domOpts,u,r.domOpts),monthOpts:e.extend({},t.monthOpts,u,r.monthOpts),dowOpts:e.extend({},t.dowOpts,u,r.dowOpts),timeHourOpts:e.extend({},t.timeHourOpts,u,r.timeHourOpts),timeMinuteOpts:e.extend({},t.timeMinuteOpts,u,r.timeMinuteOpts)});var l=y(i.initial);if(!l.valid){return this}var h,d=[],v="",m=i.customValues;if(m){for(var g in m){v+="<option value='"+m[g]+"'>"+g+"</option>\n"}}h="<span class='cron-period'>Every ";if(i.allowIntervalExpression){h+="<input type='number' class='cron-period-repeat' min='1' max='10000' style='width:32px;' step='1' value='1'/> "}h+="<select name='cron-period'>"+v+p+"</select> </span>";d["period"]=e(h).appendTo(this).data("root",this);d["interval"]=d["period"].find("input.cron-period-repeat");d["interval"].bind("change.cron",E.periodChanged).data("root",this);var b=d["period"].find("select");b.bind("change.cron",E.periodChanged).data("root",this);if(i.useGentleSelect){b.gentleSelect(u)}h="<span class='cron-block cron-block-dom'> on the <select name='cron-dom' multiple>"+a+"</select> </span>";d["dom"]=e(h).appendTo(this).data("root",this);b=d["dom"].find("select").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.domOpts)}h="<span class='cron-block cron-block-month'> of <select name='cron-month' multiple>"+f+"</select> </span>";d["month"]=e(h).appendTo(this).data("root",this);b=d["month"].find("select").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.monthOpts)}h="<span class='cron-block cron-block-mins'> at <select name='cron-mins' multiple>"+s+"</select> minutes past the hour </span>";d["mins"]=e(h).appendTo(this).data("root",this);b=d["mins"].find("select").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.minuteOpts)}h="<span class='cron-block cron-block-dow'> on <select name='cron-dow' multiple>"+c+"</select> </span>";d["dow"]=e(h).appendTo(this).data("root",this);b=d["dow"].find("select").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.dowOpts)}h="<span class='cron-block cron-block-time'> at ";h=+"<select name='cron-time-hour' class='cron-time-hour' multiple>"+o;h=+"</select>:<select name='cron-time-min' class='cron-time-min' multiple>"+s;h=+"</select> </span>";d["time"]=e(h).appendTo(this).data("root",this);b=d["time"].find("select.cron-time-hour").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.timeHourOpts)}b=d["time"].find("select.cron-time-min").data("root",this);if(i.useGentleSelect){b.gentleSelect(i.timeMinuteOpts)}this.find("input.cron-period-repeat").bind("change.cron-callback",E.somethingChanged);this.find("select").bind("change.cron-callback",E.somethingChanged);this.data("options",i).data("block",d);this.data("current_value",i.initial);return w["value"].call(this,i.initial)},value:function(e){if(!e){return b(this)}var t=y(e);var r=t.cron_type;if(!t.valid){return this}var s=this.data("block");var o={mins:t.minute,hour:t.hour,dom:t.day,month:t.month,dow:t.week};var u=this.data("options").useGentleSelect;var a,f,l=v[r];for(n=0,i=l.length;n<i;n++){a=l[n];if(a=="time"){f=s[a].find("select.cron-time-hour").val(o["hour"]);if(u){f.gentleSelect("update")}f=s[a].find("select.cron-time-min").val(o["mins"]);if(u){f.gentleSelect("update")}}else if(a=="interval"){continue}else{f=s[a].find("select").val(o[a]);if(u){f.gentleSelect("update")}}}if(t.repeatTime){s["period"].find("input.cron-period-repeat").val(t.repeatTime)}else{s["period"].find("input.cron-period-repeat").val(1)}var c=s["period"].find("select").val(r);if(u){c.gentleSelect("update")}c.trigger("change");return this}};var E={periodChanged:function(){var t,r=e(this).data("root"),s=r.data("block"),o=e(this).val();if(this.className==="cron-period-repeat"){o=s["period"].find("select").val()}r.find("span.cron-block").hide();s["interval"].hide();if(v.hasOwnProperty(o)){t=v[o];for(n=0,i=t.length;n<i;n++){s[t[n]].show()}}},somethingChanged:function(){var t=e(this).data("root"),n=t.data("options").onChange;if(n&&e.isFunction(n)){n.call(t)}}};e.fn.cron=function(t){if(w[t]){return w[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return w.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.cron")}}})(jQuery)